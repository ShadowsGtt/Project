#include "../include/head.h"
#include "../include/wechat.h"

void get_fritab(int fd)
{
    int n = -1,file_fd = -2;
    char file_name[26]; //= "FRIENDTABLE.txt";
    sprintf(file_name,"%sFRITAB.txt",username);

    char friend[10][16]= {0};

    /* 接收好友表 */
    n = recv(fd,friend,32768,0);

    if(n == -1)
        perror("recv in get_fritab");

    /* 好友表存入文件 */
    file_fd = open(file_name,O_WRONLY|O_CREAT,S_IWUSR|S_IRUSR);
    
    if(fd == -1)
        perror("open");
    
    int k = 0;
    while(friend[k][0] != 0 )
    {
        n = write(file_fd,friend[k],16);
        if(n == -1)
            perror("write in file");
        k++;
    }
    close(file_fd);
}
